{"ast":null,"code":"import React,{Component}from'react';import ProductBox from'../../components/product/ProductBox';import{GET_ALL_PRODUCT_WITH_CATEGORIES}from'../../graphql/queries.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";class CategoryPage extends Component{constructor(){super(...arguments);this.state={categoryName:null,products:[],loading:true,error:null};this.fetchProducts=async()=>{try{const response=await fetch('http://localhost/php_projects/scandiweb_store/backend/index.php',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:GET_ALL_PRODUCT_WITH_CATEGORIES})});const result=await response.json();if(result.errors){this.setState({error:result.errors[0].message,loading:false});}else{this.setState({products:result.data.products,loading:false});}}catch(err){this.setState({error:'Failed to fetch products',loading:false});}};}componentDidMount(){const categoryName=window.location.pathname.split('/')[2];this.setState({categoryName},this.fetchProducts);}render(){const{categoryName,products,loading,error}=this.state;if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsxs(\"p\",{children:[\"Error: \",error]});}let filteredProducts=categoryName==='all'?products:products.filter(product=>product.category.name===categoryName);return/*#__PURE__*/_jsx(\"div\",{className:\"categoryPage\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container py-5\",children:[/*#__PURE__*/_jsx(\"h2\",{children:categoryName?`${categoryName}`:'Loading...'}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:filteredProducts.length>0?filteredProducts.map(product=>{var _product$galleries$;return/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-4\",children:/*#__PURE__*/_jsx(ProductBox,{name:product.name,image:((_product$galleries$=product.galleries[0])===null||_product$galleries$===void 0?void 0:_product$galleries$.image_url)||'default-image-url',price:product.prices[0].amount,id:product.sku_id,stock:product.in_stock})},product.id);}):/*#__PURE__*/_jsx(\"p\",{children:\"No products found in this category.\"})})]})});}}export default CategoryPage;","map":{"version":3,"names":["React","Component","ProductBox","GET_ALL_PRODUCT_WITH_CATEGORIES","jsx","_jsx","jsxs","_jsxs","CategoryPage","constructor","arguments","state","categoryName","products","loading","error","fetchProducts","response","fetch","method","headers","body","JSON","stringify","query","result","json","errors","setState","message","data","err","componentDidMount","window","location","pathname","split","render","children","filteredProducts","filter","product","category","name","className","length","map","_product$galleries$","image","galleries","image_url","price","prices","amount","id","sku_id","stock","in_stock"],"sources":["F:/scandiweb_store/frontend/src/pages/category/CategoryPage.jsx"],"sourcesContent":["import React, { Component } from 'react';\r\nimport ProductBox from '../../components/product/ProductBox';\r\nimport { GET_ALL_PRODUCT_WITH_CATEGORIES } from '../../graphql/queries.js';\r\n\r\nclass CategoryPage extends Component {\r\n    state = {\r\n        categoryName: null,\r\n        products: [],\r\n        loading: true,\r\n        error: null,\r\n    };\r\n\r\n    componentDidMount() {\r\n        const categoryName = window.location.pathname.split('/')[2];\r\n        this.setState({ categoryName }, this.fetchProducts);\r\n    }\r\n\r\n    fetchProducts = async () => {\r\n        try {\r\n            const response = await fetch('http://localhost/php_projects/scandiweb_store/backend/index.php', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ query: GET_ALL_PRODUCT_WITH_CATEGORIES }),\r\n            });\r\n\r\n            const result = await response.json();\r\n\r\n            if (result.errors) {\r\n                this.setState({ error: result.errors[0].message, loading: false });\r\n            } else {\r\n                this.setState({ products: result.data.products, loading: false });\r\n            }\r\n        } catch (err) {\r\n            this.setState({ error: 'Failed to fetch products', loading: false });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { categoryName, products, loading, error } = this.state;\r\n\r\n        if (loading) {\r\n            return <p>Loading...</p>;\r\n        }\r\n\r\n        if (error) {\r\n            return <p>Error: {error}</p>;\r\n        }\r\n\r\n        let filteredProducts = categoryName === 'all'\r\n            ? products\r\n            : products.filter(product => product.category.name === categoryName);\r\n\r\n        return (\r\n            <div className='categoryPage'>\r\n                <div className='container py-5'>\r\n                    <h2>{categoryName ? `${categoryName}` : 'Loading...'}</h2>\r\n\r\n                    <div className='row'>\r\n                        {filteredProducts.length > 0 ? (\r\n                            filteredProducts.map((product) => (\r\n                                <div className='col-12 col-lg-4' key={product.id}>\r\n                                    <ProductBox\r\n                                        name={product.name}\r\n                                        image={product.galleries[0]?.image_url || 'default-image-url'}\r\n                                        price={product.prices[0].amount}\r\n                                        id={product.sku_id}\r\n                                        stock={product.in_stock}\r\n                                    />\r\n                                </div>\r\n                            ))\r\n                        ) : (\r\n                            <p>No products found in this category.</p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default CategoryPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}